<%- include("../../views/partials/user/header") %>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
.product-entry {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: auto;
    border: 1px solid #eee;
    padding: 0; 
    text-align: center;
    transition: transform 0.3s ease-in-out;
}

.product-entry:hover {
    transform: scale(1.05);
}

.prod-img img {
    width: 100%;
    height: auto; 
    object-fit: cover; 
    margin-bottom: 0;
}

.desc {
    padding: 10px;
}

.desc h5 {
    font-size: 18px;
    font-weight: 300;
    margin-bottom: 2px;
}

.desc .price {
    font-size: 10px;
    color: #cc4f4f;
    margin-bottom: 2px;
}

.desc .btn {
    background-color: #ff6b6b;
    color: white;
    text-transform: uppercase;
    font-size: 8px;
    padding: 5px 10px; 
    border-radius: 4px;
    transition: background-color 0.3s ease;
}

.desc .btn:hover {
    background-color: #ff4c4c;
}

 /* New Arrivals Styling  */
 .product-cart-wrap {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: auto;
    border: 1px solid #eee;
    padding: 0;
    text-align: center;
    transition: transform 0.3s ease-in-out;
}

.product-cart-wrap:hover {
    transform: scale(1.05);
}

.product-cart-wrap .product-img img {
    width: 100%;
    height: auto;
    object-fit: cover; 
    margin-bottom: 0;
}

.product-content-wrap {
    padding: 10px; 
}

.product-content-wrap h6 {
    font-size: 15px;
    font-weight: 100;
    min-height: 30px; 
    margin-bottom: 5px; 
}

.product-content-wrap h5 {
    font-size: 16px;
    color: #ff6b6b;
    margin-bottom: 5px; 
}

.product-content-wrap .btn {
    background-color: #ff6b6b;
    color: white;
    padding: 8px 8px; 
    border-radius: 4px;
    text-transform: uppercase;
    font-size:10px;
    transition: background-color 0.3s ease;
    margin-top: 5px; 
}

.product-content-wrap .btn:hover {
    background-color: #ff4c4c;
} 


.wishlist-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background-color: transparent;
    padding: 10px;
    border-radius: 50%;
    color: #ff6b6b;
    font-size: 15px;
    z-index: 10;
    transition: background-color 0.3s, color 0.3s, transform 0.3s;
}

.wishlist-btn:hover {
    background-color: rgba(255, 255, 255, 1);
    color: #ff4c4c;
    transform: translateY(-2px);
}

.wishlist-btn:active {
    transform: translateY(1px);
} 
 

</style>

		<div class="breadcrumbs">
			<div class="container">
				<div class="row">
					<div class="col">
						<p class="bread"><span><a href="/">Home</a></span> / <span>Shop</span></p>
					</div>
				</div>
			</div>
		</div>

		<div class="breadcrumbs-two">
			<div class="container">
				<div class="row">
					<div class="col">
						<div class="breadcrumbs-img" style="background-image: url(/images/bannercommonpic.JPG);">
							<h2 style="color: white;">Shop</h2>
						</div>
						<div class="menu text-center">
							<p><a href="#">New Arrivals</a> <a href="#">Best Sellers</a> <a href="#">Extended Widths</a> <a href="#">Sale</a></p>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="colorlib-featured">
			<div class="container">
				<div class="row">
					<div class="col-sm-4 text-center">
						<div class="featured">
							<div class="featured-img featured-img-2" style="background-image: url(images/casualbanner.JPG);">
								<h2>Casuals</h2>
								<p><a href="#" class="btn btn-primary btn-lg">Shop now</a></p>
							</div>
						</div>
					</div>
					<div class="col-sm-4 text-center">
						<div class="featured">
							<div class="featured-img featured-img-2" style="background-image: url(images/heelswomen.JPG);">
								<h2>Heels</h2>
								<p><a href="#" class="btn btn-primary btn-lg">Shop now</a></p>
							</div>
						</div>
					</div>
					<div class="col-sm-4 text-center">
						<div class="featured">
							<div class="featured-img featured-img-2" style="background-image: url(images/sportsbanner.JPG);">
								<h2>Sports</h2>
								<p><a href="#" class="btn btn-primary btn-lg">Shop now</a></p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="colorlib-product">
			<div class="container">
				<div class="row">
					<div class="col-sm-8 offset-sm-2 text-center colorlib-heading colorlib-heading-sm">
						<h2>View All Products</h2>
					</div>
				</div>
				<div class="row row-pb-md">
					<% if (products && products.length > 0) { %>
					<% products.forEach(product => { %>
						<div class="col-md-3 col-lg-3 mb-4 text-center">
							<div class="product-entry border">
								<a href="/product-details/<%= product._id %>" class="prod-img">
									<img src="/uploads/product-images/<%= product.productImage[0] %>" class="img-fluid" alt="picture">
								</a>
								<a href="javascript:void(0)" onclick="addToWishlist('<%= product._id %>')" class="wishlist-btn">
									<i class="fas fa-heart"></i>
								</a>
								<div class="desc">
									<h5><a href="/product-details/<%= product._id %>"><%= product.productName %></a></h5>
									<!-- <span class="price">₹<%= product.salePrice %></span> -->
								
									<span class="price"><% if (product.offerPrice && product.offerPrice < product.salePrice) { %>
																		 
										<span class="money" style="text-decoration: line-through;">₹<%= product.regularPrice %></span>
										<span class="money" style="color: red; font-weight: bold;">₹<%= product.offerPrice %></span>
									  <% } else if (product.salePrice < product.regularPrice) { %>
									   
										<span class="money" style="text-decoration: line-through;">₹<%= product.regularPrice %></span>
										<span class="money" style="color: red; font-weight: bold;">₹<%= product.salePrice %></span>
									  <% } else if (product.salePrice === product.regularPrice && product.offerPrice && product.offerPrice < product.salePrice) { %>
										
										<span class="money" style="text-decoration: line-through;">₹<%= product.regularPrice %></span>
										<span class="money" style="color: red; font-weight: bold;">₹<%= product.offerPrice %></span>
									  <% } else { %>
									  
										<span class="money">₹<%= product.regularPrice %></span>
									  <% } %></span>						
								</div>
							</div>
						</div>
					<% }) %>
					<% } else { %>
						<p>No products found</p>
					<% } %>
				</div>
		
                
				<section class="product spad">
					<div class="container">
						<div class="row">
							<div class="col-lg-12 text-center">
								<h3>New Arrivals</h3>
							</div>
						</div>
						<div class="row product__filter">
							<% if (newArrivals && newArrivals.length > 0) { %>
								<% newArrivals.forEach(product => { %>
									<div class="col-lg-3 col-md-4 col-sm-6 mb-4">
										<div class="product-cart-wrap mb-30">
											<div class="product-img-action-wrap">
												<div class="product-img product-img-zoom">
													<a href="/product-details/<%= product._id %>">
														<img class="default-img" src="/uploads/product-images/<%= product.productImage[0] %>" alt="<%= product.productName %>">
													</a>
												</div>
												<a href="javascript:void(0)" onclick="addToWishlist('<%= product._id %>')" class="wishlist-btn">
													<i class="fas fa-heart"></i>
												</a>
												
											</div>
											<div class="product-content-wrap text-center">
												<h6><%= product.productName %></h6>
												
												<!-- <h5>₹<%= product.salePrice %></h5> -->
												<span class="price"><% if (product.offerPrice && product.offerPrice < product.salePrice) { %>
																		 
													<span class="money" style="text-decoration: line-through;">₹<%= product.regularPrice %></span>
													<span class="money" style="color: red; font-weight: bold;">₹<%= product.offerPrice %></span>
												  <% } else if (product.salePrice < product.regularPrice) { %>
												   
													<span class="money" style="text-decoration: line-through;">₹<%= product.regularPrice %></span>
													<span class="money" style="color: red; font-weight: bold;">₹<%= product.salePrice %></span>
												  <% } else if (product.salePrice === product.regularPrice && product.offerPrice && product.offerPrice < product.salePrice) { %>
													
													<span class="money" style="text-decoration: line-through;">₹<%= product.regularPrice %></span>
													<span class="money" style="color: red; font-weight: bold;">₹<%= product.offerPrice %></span>
												  <% } else { %>
												  
													<span class="money">₹<%= product.regularPrice %></span>
												  <% } %></span>
												 
											</div>
										</div>
									</div>
								<% }); %>
							<% } else { %>
								<p>No new arrivals found</p>
							<% } %>
						</div>
					</div>
				</section>
					  

				<div class="row">
					<div class="col-md-12 text-center">
						<div class="block-27">
							<div class="row">
								<div class="col-md-12 text-center">
									<div class="block-27">
										<ul>
											<% if (currentPage > 1) { %>
												<li><a href="?page=<%= currentPage - 1 %>"><i class="ion-ios-arrow-back"></i></a></li>
											<% } %>
							
											<% for (let i = 1; i <= totalPages; i++) { %>
												<li class="<%= currentPage === i ? 'active' : '' %>">
													<a href="?page=<%= i %>"><%= i %></a>
												</li>
											<% } %>
							
											<% if (currentPage < totalPages) { %>
												<li><a href="?page=<%= currentPage + 1 %>"><i class="ion-ios-arrow-forward"></i></a></li>
											<% } %>
										</ul>
									</div>
								</div>
							</div>
							
		            </div>
					</div>
				</div>
			</div>
		</div>

		<div class="colorlib-partner">
			<div class="container">
				<div class="row">
					<div class="col-sm-8 offset-sm-2 text-center colorlib-heading colorlib-heading-sm">
						<h2>Trusted Partners</h2>
					</div>
				</div>
				<div class="row">
					<div class="col partner-col text-center">
						<img src="images/brand-1.jpg" class="img-fluid" alt="Free html4 bootstrap 4 template">
					</div>
					<div class="col partner-col text-center">
						<img src="images/brand-2.jpg" class="img-fluid" alt="Free html4 bootstrap 4 template">
					</div>
					<div class="col partner-col text-center">
						<img src="images/brand-3.jpg" class="img-fluid" alt="Free html4 bootstrap 4 template">
					</div>
					<div class="col partner-col text-center">
						<img src="images/brand-4.jpg" class="img-fluid" alt="Free html4 bootstrap 4 template">
					</div>
					<div class="col partner-col text-center">
						<img src="images/brand-5.jpg" class="img-fluid" alt="Free html4 bootstrap 4 template">
					</div>
				</div>
			</div>
		</div>
		<%-include("../../views/partials/user/footer")%>
		<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

		<script>
			async function addToWishlist(productId) {
    try {
        
        const response = await fetch('/wishlist', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ productId }),
        });

        
        if (response.ok) {
            const result = await response.json();
            
            
            Swal.fire({
                title: 'Added to Wishlist!',
                text: result.message || 'The product was added to your wishlist.',
                icon: 'success',
                confirmButtonText: 'Continue Shopping',
                timer: 3000,
                timerProgressBar: true,
            });
        } else {
            
            Swal.fire({
                title: 'Error',
                text: 'Error adding product to wishlist',
                icon: 'error',
                confirmButtonText: 'Try Again'
            });
        }
    } catch (error) {
        console.error('Error adding to wishlist:', error);
        Swal.fire({
            title: 'Error',
            text: 'An error occurred. Please try again later.',
            icon: 'error',
            confirmButtonText: 'OK'
        });
    }
}
	     </script>

   <style>

.product-entry {
    border: 1px solid #ddd;
    border-radius: 8px;
    background-color: #fff;
    transition: transform 0.3s ease;
    display: flex;
    flex-direction: column; 
    align-items: center;
    padding: 20px;
    text-align: center; 
}

.product-entry:hover {
    transform: translateY(-5px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.prod-img img {
    width: 100%; 
    height: auto;
    object-fit: cover;
    border-radius: 8px;
}

.wishlist-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    background: white;
    padding: 8px;
    border-radius: 50%;
    color: red;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.wishlist-btn:hover {
    background: red;
    color: white;
}

.desc {
    margin-top: 15px;
}

.price {
    color: #333;
    font-size: 1.1rem;
    font-weight: bold;
}

.money {
    display: block;
    margin: 5px 0;
}

/* For medium screens (Tablets, 768px) */
@media (max-width: 992px) {
    .col-lg-3 {
        flex: 1 1 100%; 
    }
}

/* For small screens (Mobile, 768px and below) */
@media (max-width: 768px) {
    .col-sm-6 {
        flex: 1 1 100%;
    }
    .product-entry {
        padding: 15px; 
    }
}

@media (max-width: 576px) {
    .col-12 {
        flex: 1 1 100%;
    }
    .product-entry {
        padding: 10px; 
    }
}
</style>