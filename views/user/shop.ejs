<%- include("../../views/partials/user/header") %>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
.product-entry {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: auto;
    border: 1px solid #eee;
    padding: 0; 
    text-align: center;
    transition: transform 0.3s ease-in-out;
}

.product-entry:hover {
    transform: scale(1.05);
}

.prod-img img {
    width: 100%;
    height: auto; 
    object-fit: cover; 
    margin-bottom: 0;
}

.desc {
    padding: 10px;
}

.desc h5 {
    font-size: 18px;
    font-weight: 300;
    margin-bottom: 2px;
}

.desc .price {
    font-size: 10px;
    color: #cc4f4f;
    margin-bottom: 2px;
}

.desc .btn {
    background-color: #ff6b6b;
    color: white;
    text-transform: uppercase;
    font-size: 8px;
    padding: 5px 10px; 
    border-radius: 4px;
    transition: background-color 0.3s ease;
}

.desc .btn:hover {
    background-color: #ff4c4c;
}

/* New Arrivals Styling */
.product-cart-wrap {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: auto;
    border: 1px solid #eee;
    padding: 0;
    text-align: center;
    transition: transform 0.3s ease-in-out;
}

.product-cart-wrap:hover {
    transform: scale(1.05);
}

.product-cart-wrap .product-img img {
    width: 100%;
    height: auto;
    object-fit: cover; 
    margin-bottom: 0;
}

.product-content-wrap {
    padding: 10px; 
}

.product-content-wrap h6 {
    font-size: 15px;
    font-weight: 100;
    min-height: 30px; 
    margin-bottom: 5px; 
}

.product-content-wrap h5 {
    font-size: 16px;
    color: #ff6b6b;
    margin-bottom: 5px; 
}

.product-content-wrap .btn {
    background-color: #ff6b6b;
    color: white;
    padding: 8px 8px; 
    border-radius: 4px;
    text-transform: uppercase;
    font-size:10px;
    transition: background-color 0.3s ease;
    margin-top: 5px; 
}

.product-content-wrap .btn:hover {
    background-color: #ff4c4c;
}

/* Wishlist button styling */
.wishlist-btn {
    position: absolute;
    top: 10px;
    right: 10px;
    background-color: transparent;
    padding: 10px;
    border-radius: 50%;
    color: #ff6b6b;
    font-size: 15px;
    z-index: 10;
    transition: background-color 0.3s, color 0.3s, transform 0.3s;
}

.wishlist-btn:hover {
    background-color: rgba(255, 255, 255, 1);
    color: #ff4c4c;
    transform: translateY(-2px);
}

.wishlist-btn:active {
    transform: translateY(1px);
}


</style>

		<div class="breadcrumbs">
			<div class="container">
				<div class="row">
					<div class="col">
						<p class="bread"><span><a href="/">Home</a></span> / <span>Shop</span></p>
					</div>
				</div>
			</div>
		</div>

		<div class="breadcrumbs-two">
			<div class="container">
				<div class="row">
					<div class="col">
						<div class="breadcrumbs-img" style="background-image: url(/images/cover-img-1.jpg);">
							<h2>Shop</h2>
						</div>
						<div class="menu text-center">
							<p><a href="#">New Arrivals</a> <a href="#">Best Sellers</a> <a href="#">Extended Widths</a> <a href="#">Sale</a></p>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="colorlib-featured">
			<div class="container">
				<div class="row">
					<div class="col-sm-4 text-center">
						<div class="featured">
							<div class="featured-img featured-img-2" style="background-image: url(images/men.jpg);">
								<h2>Casuals</h2>
								<p><a href="#" class="btn btn-primary btn-lg">Shop now</a></p>
							</div>
						</div>
					</div>
					<div class="col-sm-4 text-center">
						<div class="featured">
							<div class="featured-img featured-img-2" style="background-image: url(images/women.jpg);">
								<h2>Heels</h2>
								<p><a href="#" class="btn btn-primary btn-lg">Shop now</a></p>
							</div>
						</div>
					</div>
					<div class="col-sm-4 text-center">
						<div class="featured">
							<div class="featured-img featured-img-2" style="background-image: url(images/item-11.jpg);">
								<h2>Sports</h2>
								<p><a href="#" class="btn btn-primary btn-lg">Shop now</a></p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="colorlib-product">
			<div class="container">
				<div class="row">
					<div class="col-sm-8 offset-sm-2 text-center colorlib-heading colorlib-heading-sm">
						<h2>View All Products</h2>
					</div>
				</div>
				<div class="row row-pb-md">
					<% if (products && products.length > 0) { %>
					<% products.forEach(product => { %>
						<div class="col-md-3 col-lg-3 mb-4 text-center">
							<div class="product-entry border">
								<a href="/product-details/<%= product._id %>" class="prod-img">
									<img src="/uploads/product-images/<%= product.productImage[0] %>" class="img-fluid" alt="picture">
								</a>
								<div class="desc">
									<h5><a href="/product-details/<%= product._id %>"><%= product.productName %></a></h5>
									<!-- <span class="price">₹<%= product.salePrice %></span> -->
								
									<span class="price"><% if (product.offerPrice && product.offerPrice < product.salePrice) { %>
																		 
										<span class="money" style="text-decoration: line-through;">₹<%= product.regularPrice %></span>
										<span class="money" style="color: red; font-weight: bold;">₹<%= product.offerPrice %></span>
									  <% } else if (product.salePrice < product.regularPrice) { %>
									   
										<span class="money" style="text-decoration: line-through;">₹<%= product.regularPrice %></span>
										<span class="money" style="color: red; font-weight: bold;">₹<%= product.salePrice %></span>
									  <% } else if (product.salePrice === product.regularPrice && product.offerPrice && product.offerPrice < product.salePrice) { %>
										
										<span class="money" style="text-decoration: line-through;">₹<%= product.regularPrice %></span>
										<span class="money" style="color: red; font-weight: bold;">₹<%= product.offerPrice %></span>
									  <% } else { %>
									  
										<span class="money">₹<%= product.regularPrice %></span>
									  <% } %></span>



									<!-- <form id="addToCartForm-<%= product._id %>" onsubmit="return false;">
										<input type="hidden" name="productId" value="<%= product._id %>">
										<input type="hidden" name="quantity" value="1">
										<button class="btn" type="button" onclick="addToCart('<%= product._id %>')">Add to Cart</button>
									</form>				 -->
								</div>
							</div>
						</div>
					<% }) %>
					<% } else { %>
						<p>No products found</p>
					<% } %>
				</div>
		
                
				<section class="product spad">
					<div class="container">
						<div class="row">
							<div class="col-lg-12 text-center">
								<h3>New Arrivals</h3>
							</div>
						</div>
						<div class="row product__filter">
							<% if (newArrivals && newArrivals.length > 0) { %>
								<% newArrivals.forEach(product => { %>
									<div class="col-lg-3 col-md-4 col-sm-6 mb-4">
										<div class="product-cart-wrap mb-30">
											<div class="product-img-action-wrap">
												<div class="product-img product-img-zoom">
													<a href="/product-details/<%= product._id %>">
														<img class="default-img" src="/uploads/product-images/<%= product.productImage[0] %>" alt="<%= product.productName %>">
													</a>
												</div>
												<a href="/wishlist/<%= product._id %>" class="wishlist-btn">
													<i class="fas fa-heart"></i>
												</a>
											</div>
											<div class="product-content-wrap text-center">
												<h6><%= product.productName %></h6>
												
												<h5>₹<%= product.salePrice %></h5>
																							 
											</div>
										</div>
									</div>
								<% }); %>
							<% } else { %>
								<p>No new arrivals found</p>
							<% } %>
						</div>
					</div>
				</section>
					  

				<div class="row">
					<div class="col-md-12 text-center">
						<div class="block-27">
							<div class="row">
								<div class="col-md-12 text-center">
									<div class="block-27">
										<ul>
											<% if (currentPage > 1) { %>
												<li><a href="?page=<%= currentPage - 1 %>"><i class="ion-ios-arrow-back"></i></a></li>
											<% } %>
							
											<% for (let i = 1; i <= totalPages; i++) { %>
												<li class="<%= currentPage === i ? 'active' : '' %>">
													<a href="?page=<%= i %>"><%= i %></a>
												</li>
											<% } %>
							
											<% if (currentPage < totalPages) { %>
												<li><a href="?page=<%= currentPage + 1 %>"><i class="ion-ios-arrow-forward"></i></a></li>
											<% } %>
										</ul>
									</div>
								</div>
							</div>
							
		            </div>
					</div>
				</div>
			</div>
		</div>

		<div class="colorlib-partner">
			<div class="container">
				<div class="row">
					<div class="col-sm-8 offset-sm-2 text-center colorlib-heading colorlib-heading-sm">
						<h2>Trusted Partners</h2>
					</div>
				</div>
				<div class="row">
					<div class="col partner-col text-center">
						<img src="images/brand-1.jpg" class="img-fluid" alt="Free html4 bootstrap 4 template">
					</div>
					<div class="col partner-col text-center">
						<img src="images/brand-2.jpg" class="img-fluid" alt="Free html4 bootstrap 4 template">
					</div>
					<div class="col partner-col text-center">
						<img src="images/brand-3.jpg" class="img-fluid" alt="Free html4 bootstrap 4 template">
					</div>
					<div class="col partner-col text-center">
						<img src="images/brand-4.jpg" class="img-fluid" alt="Free html4 bootstrap 4 template">
					</div>
					<div class="col partner-col text-center">
						<img src="images/brand-5.jpg" class="img-fluid" alt="Free html4 bootstrap 4 template">
					</div>
				</div>
			</div>
		</div>
		<%-include("../../views/partials/user/footer")%>
		<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

		<!-- <script>
			function addToCart(productId) {
			  const form = document.getElementById(`addToCartForm-${productId}`);
			  const formData = new FormData(form);
			
			  fetch("/add-cart", {
				method: "POST",
				headers: {
				  'Content-Type': 'application/json',
				},
				body: JSON.stringify(Object.fromEntries(formData)),
				credentials: 'include' 
			  })
			  .then(response => {
				return response.json().then(data => {
				  if (!response.ok) {
					throw data;
				  }
				  return data;
				});
			  })
			  .then(data => {
				if (data.message === 'Item already in cart') {
				  Swal.fire({
					icon: 'info',
					title: 'Already in Cart',
					text: 'This item is already in your cart.'
				  });
				} else {
				  Swal.fire({
					icon: 'success',
					title: 'Success',
					text: data.message
				  });
				}
				if (data.cartItemsCount) {
				  updateCartItemCount(data.cartItemsCount);
				}
			  })
			  .catch(error => {
				console.error('Error:', error);
				if (error.error === 'Please login to add items to cart') {
				  Swal.fire({
					icon: 'warning',
					title: 'Authentication Required',
					text: 'Please login to add items to cart',
					showCancelButton: true,
					confirmButtonText: 'Login',
					cancelButtonText: 'Cancel'
				  }).then((result) => {
					if (result.isConfirmed) {
					  window.location.href = '/login';
					}
				  });
				} else {
				  Swal.fire({
					icon: 'error',
					title: 'Error',
					text: error.error || 'An error occurred, please login and try again'
				  });
				}
			  });
			}
			
			function updateCartItemCount(count) {
			  const cartCountElement = document.getElementById('cartItemCount');
			  if (cartCountElement) {
				cartCountElement.textContent = count;
			  }
			}
				</script>

  -->